# docker ìš°ë¶„íˆ¬

![](./IMG/20250703/0001.png)

```
sudo apt update
sudo apt install -y vim net-tools openssh-server htop tree
ifconfig
ping -c 2 192.168.56.1

```

## ëª¨ë°”

- Set up Docker's apt repository.
```
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \
  $(. /etc/os-release && echo "${UBUNTU_CODENAME:-$VERSION_CODENAME}") stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
```
- Install the Docker packages.
```
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

- docker version

```
sudo usermdo -aG docker kevin
sudo systemctl 
```

## Docker í¬íŠ¸ í¬ì›Œë”©ì˜ ì›ë¦¬ë¥¼ í™•ì¸í•˜ê³ , ì‹¤ì œë¡œ ë¦¬ëˆ…ìŠ¤ì—ì„œ ì–´ë–¤ ë„¤íŠ¸ì›Œí¬ íë¦„ê³¼ ë°©í™”ë²½(NAT) ì„¤ì •ì´ ìë™ìœ¼ë¡œ ì ìš©ë˜ëŠ”ì§€ ì‹¤ìŠµí•˜ëŠ” ê³¼ì •.
```
~$ docker run -d --name=myweb -p  -m=1G --cpu-share=1024 8001:80 nginx:1.27.3-alpine
~$ docker ps -a 
~$ docker inspect myweb | grep -i ipaddress
		172.17.0.2

web: 192.168.56.101:8001
	ã„´ ì„œë²„(VM) Host -> 192.168.56.101:8001 -> docker0(BR) -> 172.17.0.2:80(eth0) -> nginxd
			_______________________________________________________________________
				ã„´ docker-proxy (process -> PID)

~$ sudo netstat -ntlp | grep 8001
~$ ps -ef | grep docker-procxy(PID)
~$ sudo iptables -t nat -L -n
```

# container ë€?

- containerëŠ” Process ë‹¤! -> ps ì¡°íšŒ ê°€ëŠ¥
- contianerëŠ” imageì˜ ë³µì‚¬ë³¸(snapshot)ì´ë‹¤

# Docker ì»¨í…Œì´ë„ˆ íŒŒì¼ ì‹œìŠ¤í…œ ì—°ë™ ê²°ë¡ 

## ğŸ” í•µì‹¬ ê²°ë¡ 
Docker ì»¨í…Œì´ë„ˆì˜ íŒŒì¼ì€ **í˜¸ìŠ¤íŠ¸ì˜ íŒŒì¼ ì‹œìŠ¤í…œ(`/var/lib/docker/overlay2`)ì— ì‹¤ì œë¡œ ì¡´ì¬**í•˜ë©°, ì»¨í…Œì´ë„ˆëŠ” ì´ë¥¼ ê²©ë¦¬ëœ ë…ë¦½ ê³µê°„ì²˜ëŸ¼ ë³´ì—¬ì¤„ ë¿ì´ë‹¤.

---

## âœ… ìš”ì•½
| êµ¬ë¶„ | ë‚´ìš© |
|------|------------------------------|
| ì»¨í…Œì´ë„ˆ ê´€ì  | ë…ë¦½ì ì¸ íŒŒì¼ ì‹œìŠ¤í…œì²˜ëŸ¼ ë³´ì„ |
| í˜¸ìŠ¤íŠ¸ ê´€ì  | `/var/lib/docker/overlay2/.../merged` ë‚´ë¶€ì— ì‹¤ì œ íŒŒì¼ì´ ì¡´ì¬ |
| ì˜ë¯¸ | ì»¨í…Œì´ë„ˆì˜ íŒŒì¼ì€ í˜¸ìŠ¤íŠ¸ì— ë¬¼ë¦¬ì ìœ¼ë¡œ ì €ì¥ë˜ê³ , DockerëŠ” ì´ë¥¼ ê²©ë¦¬ëœ viewë¡œ ì œê³µí•¨ |

---

## ğŸ”§ ì‹¤ìŠµ íë¦„
1. `docker run`ìœ¼ë¡œ Python ì»¨í…Œì´ë„ˆ ìƒì„±
2. `docker cp`ë¡œ íŒŒì¼ ë³µì‚¬ â†’ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ í™•ì¸
3. ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ íŒŒì¼ ì‹¤í–‰
4. í˜¸ìŠ¤íŠ¸ì˜ `/var/lib/docker/overlay2` ê²½ë¡œì—ì„œ ì‹¤ì œ íŒŒì¼ í™•ì¸
5. ì»¨í…Œì´ë„ˆì˜ íŒŒì¼ê³¼ í˜¸ìŠ¤íŠ¸ì˜ overlay2 íŒŒì¼ì´ ë™ì¼í•¨ì„ ê²€ì¦

---

## ğŸš© í•µì‹¬ í¬ì¸íŠ¸
- ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ ìƒì„±í•œ íŒŒì¼ì€ í˜¸ìŠ¤íŠ¸ì—ì„œë„ ì ‘ê·¼ ê°€ëŠ¥ (ë¬¼ë¦¬ì ìœ¼ë¡œ ì €ì¥ë¨)
- DockerëŠ” `overlay2` ìŠ¤í† ë¦¬ì§€ ë“œë¼ì´ë²„ë¥¼ ì´ìš©í•´ íŒŒì¼ì„ ê´€ë¦¬
- ì»¨í…Œì´ë„ˆì˜ íŒŒì¼ = í˜¸ìŠ¤íŠ¸ overlay2 ê²½ë¡œì˜ íŒŒì¼ (ë‹¨, ì ‘ê·¼ ê²½ë¡œë§Œ ë‹¤ë¦„)

---

## ğŸŒ± í™•ì¥ ê°œë…
- íŒŒì¼ ê³µìœ , ë°ì´í„° ì˜ì†ì„±ì„ ì›í•œë‹¤ë©´ **Docker Volume (-v ì˜µì…˜) ì‚¬ìš© ê¶Œì¥**
- ë³¼ë¥¨ì„ ì‚¬ìš©í•˜ë©´ overlay2ê°€ ì•„ë‹Œ **ëª…ì‹œì ì¸ í˜¸ìŠ¤íŠ¸ ê²½ë¡œ**ë¥¼ ì»¨í…Œì´ë„ˆì— ì§ì ‘ ì—°ê²°í•  ìˆ˜ ìˆìŒ


lotto.py

```
from random import shuffle
from time import sleep
gamenum = input('ë¡œë˜ ê²Œì„ íšŒìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”: ')
for i in range(int(gamenum)):
   balls = [x+1 for x in range(45)]
   ret = []
   for j in range(6):
      shuffle(balls)
      number = balls.pop()
      ret.append(number)
   print('ë¡œë˜ë²ˆí˜¸[%d]: ' %(i+1), end='')
   print(ret)
   sleep(1)
```



```
kevin@k8s-master:~/LABs$ docker run -it -d --name=py-test python:3.10-slim
kevin@k8s-master:~/LABs$ docker ps
kevin@k8s-master:~/LABs$ docker cp lotto.py py-test:/lotto.py
kevin@k8s-master:~/LABs$ docker exec -it py-test bash
root@bc2fd58eda97:/# ls
lotto.py

kevin@k8s-master:~/LABs$ docker exec -it py-test python3 /lotto.py

root@k8s-master:~# find /var/lib/docker/ -name lotto.py
root@k8s-master:~# cd /var/lib/docker/overlay2/f8aa0b059f49fa5d2a01adcc2b064921c023fc1a52296aa7d8cf5/merged
root@k8s-master:/var/lib/docker/overlay2/f8aa0b059f49fa5d2a01adcc2b064921c023fc1810687aa7d8cf5/merged# ls
bin   dev  home  lib64     media  opt   root  sbin  sys  usr
boot  etc  lib   lotto.py

kevin@k8s-master:~$ docker exec -it py-test bash
root@bc2fd58eda97:/# ls
bin   dev  home  lib64     media  opt   root  sbin  sys    test2  usr
boot  etc  lib   lotto.py  mnt    proc  run   srv   test1  tmp    var
```