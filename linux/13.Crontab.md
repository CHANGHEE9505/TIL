# π“ Crontab

## 1. κ°μ”

μ‹μ¤ν…μ—μ„ νΉμ • μ‹κ°„μ— μ›ν•λ” μ‘μ—…μ„ μν–‰ν•  μ μλ„λ΅ ν•΄μ£Όλ” μ¤μΌ€μ¥΄λ§<br>
μ‹μ¤ν… λ°±μ—…, μ κ²€ λ“±κ³Ό κ°™μ΄ μ£Όλ΅ μƒλ²½ μ‹κ°„λ€μ— ν•΄μ•Ό ν•λ” μ‘μ—…λ“¤μ„ μλ™μ μΌλ΅ ν•΄ μ£Όλ” μ©λ„λ΅ λ§μ΄ μ‚¬μ©λλ‹¤.<br>
μ‹¤λ¬΄μ—μ„λ” 'Shell Scripting'κ³Ό ν•¨κ» μ£Όλ΅ μ‚¬μ©λλ‹¤.

## 2. μ£Όμ μ‚¬ν•­

ν„μ¬ μ‹κ°„μ„ κΈ°μ¤€μΌλ΅ μ μ©λκΈ° λ•λ¬Έμ— μ‘μ—…ν•  λ•λ” μ‹μ¤ν…μ μ‹κ°„μ„ μ •ν™•ν•κ² μ„¤μ •μ„ ν•΄μ•Ό ν•λ‹¤. μ¦‰, Crontabμ„ μ„¤μ •ν• λ‹¤μ μ‹κ°„μ„ λ³€κ²½ν•λ©΄ μ„¤μ • λ‚΄μ©μ΄ λ°μμ΄ μ•λλ‹¤.

## 3. μ‚¬μ©λ²•
λ…λ Ήμ–΄ 
```
crontab -u <μ‚¬μ©μλ…> <μµμ…>
```
μµμ…
- μμ•½λ μ‘μ—… μƒμ„±, μμ •     crontab -e
- μμ•½λ μ‘μ—… λ¦¬μ¤νΈ ν™•μΈ    crontab -l
- μμ•½λ μ‘μ—… μ‚­μ            crontab -r

κµ¬λ¶„
- <λ¶„><μ‹><μΌ><μ›”><μ”μΌ><λ…λ Ήμ–΄>

- μ„¤λ…
    - λ¶„ (0 ~ 59)
    - μ‹ (0 ~ 23)
    - μΌ (1 ~ 31)
    - μ›” (1 ~ 12)
    - μ”μΌ (0(μΌμ”μΌ) ~ 6(ν† μ”μΌ))
    - λ…λ Ήμ–΄ (λ¦¬λ…μ¤μ—μ„ μ‚¬μ© κ°€λ¥ν• λ¨λ“  λ…λ Ήμ–΄)
    - 'λ…λ Ήμ–΄' ν•„λ“λ¥Ό μ μ™Έν• 5κ°μ ν•„λ“μ— '*'κ°€ μλ” κ²½μ°μ—λ” 'λ¨λ“  κ²ƒ'μ„ μλ―Έν•λ‹¤.μ¦‰, λ§¤λ¶„, λ§¤μ‹, λ§¤μΌ, λ§¤μ›”, λ§¤μ£Ό, 

## 4. μ‹¤μµ

### μμ  1. λ‹¤μμ μ΅°κ±΄μΌλ΅ μ‘μ—…ν•λ‹¤.

'λ§¤λ¶„, λ§¤μ‹, λ§¤μΌ, λ§¤μ›”, λ§¤μ£Ό' λ§λ‹¤ '/export/home/samadal'μ— λΉ λ¬Έμ„ νμΌμ„ μƒμ„±ν•λ‹¤.

```
crontab -u root -e
```
```
* * * * * touch /export/home/samadal/cloud
```

```
[root@localhost ~]#
[root@localhost ~]# ls -l /export/home/samadal/
ν•©κ³„ 0
-rw-r--r-- 1 root root 0  5μ›”  7 13:05 cloud
[root@localhost ~]# ls -l /export/home/samadal/
ν•©κ³„ 0
-rw-r--r-- 1 root root 0  5μ›”  7 13:06 cloud
```
ν¬λ΅ νƒ­ μ‚­μ <br>
r μµμ… = remove
```
[root@localhost ~]# crontab -u root -r
[root@localhost ~]#
[root@localhost ~]# crontab -l
no crontab for root
[root@localhost ~]#
```

### μμ  2. λ‹¤μμ μ΅°κ±΄μΌλ΅ μ‘μ—…ν•λ‹¤.

- λ§¤μ£Ό ν™”μ”μΌ μƒλ²½ 1μ‹ 20λ¶„μ— μ ‘μ†ν• μ‚¬μ©μ λ©λ΅μ„ νμΌ(who.log)λ΅ μ €μ¥ <br>
λ‹¨, 1μ‹ 19λ¶„μ— λ””λ ‰ν„°λ¦¬ (/cloud/)λ¥Ό λ¨Όμ € μƒμ„±ν•λ‹¤.
### μ‹¤ν–‰
```
-> 19 1 * * 2 mkdir /cloud
-> 20 1 * * 2 who > /cloud/who.log
```

### μμ  3. λ‹¤μμ μ΅°κ±΄μΌλ΅ μ‘μ—…ν•λ‹¤.
- 'μμ  2'μ—μ„ 1μ‹ 21λ¶„ μ— νμΌ(who.log)μ„ '/tmp' λ΅ μ΄λ™ν•κ³ 
λ””λ ‰ν„°λ¦¬ (/cloud/)λ¥Ό μ‚­μ ν•λ‹¤.

- μ‹¤ν–‰

```
[root@localhost ~]# crontab -u root -l
19 1 * * 2 mkdir /cloud
20 1 * * 2 who > /cloud/who.log
21 1 * * 2 mv /cloud/who.lg /tmp
21 1 * * 2 rm -rf /cloud
```

### μμ  4. λ‹¤μμ μ΅°κ±΄μΌλ΅ μ‘μ—…ν•λ‹¤.

λ§¤μΌ μƒλ²½ 6μ‹ μ •κ°μ— 'μμ  2'μ™€ 'μμ  3'μ„ λ™μΌν•κ² μ‘μ—…ν•λ‹¤.<br>
λ‹¨, λ¨λ“  μ‘μ—…μ€ 'Shell Scripting'μ„ μ΄μ©ν•λ„λ΅ ν•λ‹¤.

- μ‹¤ν–‰

pwd: /export/home/samadal
```
#!/bin/bash

mkdir /cloud
who > /cloud/who.log
mv /cloud/who.log /tmp
rm -rf /cloud
```

### μμ  5. λ‹¤μμ μ΅°κ±΄μΌλ΅ μ‘μ—…ν•λ‹¤.
2025λ…„ 5μ›” 5μΌ μ¤ν›„ 5μ‹ 25λ¶„μ— μ‚¬μ©μ μ •λ³΄ μ¤‘ 'samadal'μ— λ€ν• μ •λ³΄λ§ νμΌλ΅ μ €μ¥ν•λ‹¤.<br>

λ‹¨, μ¶λ ¥λ λ‚΄μ©μ μ €μ¥μ€ '/tmp'μ— 'samadal_050517252025.txt'λ΅ μ €μ¥ν•λ‹¤. <br>

λν• μ‹κ°„ μ •λ³΄λ¥Ό μλ™μΌλ΅ μ…λ ¥λλ„λ΅ ν•λ‹¤.

- μ‹¤ν–‰

dateμ νΉμκΈ°λ¥
- day, Date
- month, Minute
- second, Second

```
[root@localhost samadal]# date +'%d'
06
[root@localhost samadal]# date +'%D'
05/06/25
[root@localhost samadal]# date +'%m'
05
[root@localhost samadal]# date +'%M'
05
[root@localhost samadal]# date +'%s'
1746479224
[root@localhost samadal]# date +'%S'
06
```

```
#!/bin/bash
'samadal' /etc/passwd > /tmp/samadal_`date +'%m%d%H%M%Y'`.txt
```

```
[root@localhost samadal]# ls -l /tmp/
ν•©κ³„ 4
-rw-r--r-- 1 root root   0  5μ›”  5 17:25 samadal_050517252025.txt
```

```
[root@localhost samadal]# crontab -u root -l
25 17 5 5 * /export/home/samadal/samdate.sh
```

## κΈ°νƒ€μμ 
λ§¤ 1λ¶„λ§λ‹¤ μ‚¬μ©μλ¥Ό ν•λ‚μ”© μƒμ„±ν•λ„λ΅ μ„¤μ •<br>
λ‹¨μΌ μ„¤μ •μ—μ„ μ—¬λ¬ κ°κ°€ λ™μ‘ν•λ„λ΅ μ„¤μ • <br>
5λ¶„λ§λ‹¤ μ‹¤ν–‰λλ„λ΅ μ„¤μ • <br>
λ…λ Ήμ–΄
```
*/5 * * * 
```

κ°™μ€ μ‘μ—…μ„ ν•λ£¨μ— λ‘ λ² μ‹¤ν–‰λλ„λ΅ μ„¤μ •(κ³µλ°±μ—†μ΄ μ‰Όν‘λ΅ κµ¬λ¶„)<br>
λ…λ Ήμ–΄
```
0 2,14 * * * 
```
<br>


λ§¤μΌ μƒλ²½ 4μ‹ 30λ¶„μ— λ°μ΄ν„° λ² μ΄μ¤ νμΌμ„ λ°±μ—…ν•κ³  λ°±μ—…ν• λ‚΄μ©μ„ ν™•μΈν•κ³  ν™•μΈν• λ©λ΅μ„ νμΌλ΅ μ €μ¥

λ΅μ»¬ μ‹μ¤ν…μ— μλ” db λ°±μ—…λ³Έμ„ μ›κ²©μ§€μ— μλ” λ°±μ—…μ„λ²„λ΅ λ°±μ—…ν•λ” λ°©λ²•

- scpλ¥Ό μ΄μ©ν• λ°©λ²•
    - λ΅μ»¬ μ‹μ¤ν…(Private key)κ³Ό λ°±μ—… μ‹μ¤ν…(public key)μ— SSH λ³΄μ• μ„¤μ •μ„ ν•λ‹¤.
    - DB Backup
    ```
    mysqldump -uroot -ppwroot mysql > /export/home/samadal/db.sql
    ```
    - SSH μ „μ†΅
    - scp /export/home/samadal/db.sql samadal@λ°±μ—…μ„λ²„IP/home/samadal

MariaDBλ¥Ό μ΄μ©ν• λ°©λ²•
- μ›κ²©μ§€μ— μλ” DB μ„λ²„μ— μ ‘κ·Ό
```
mysql -h DBμ„λ²„IP -uroot -p mysql
MariaDB(DBμ„λ²„)> 
```
μ΄ λ°©λ²•μ€ μ›κ²©μ— μλ” DBμ— μ ‘κ·Ό ν›„ μ„¤μ • μ‘μ—…μ„ ν•λ” μ©λ„λ΅ λ°–μ— μ‚¬μ©ν•  μκ°€ μ—†λ‹¤. μ¦‰, SSHλ¥Ό μ΄μ©ν• λ°±μ—…μ„ ν•  μκ°€ μ—†λ‹¤.

## RSA κ³µκ°ν‚¤

1. without keyGen

: Serverμ—μ„μ μ‘μ—…(μ ‘μ†μ„ ν—μ©ν•λ” λ†, 192.168.10.132)<br>

- κ³µκ°ν‚¤κ°€ μ €μ¥λ  λ””λ ‰ν„°λ¦¬ μƒμ„±
![](./img/Crontabimg/2.png)

- SSH ν™κ²½μ„¤μ •
```
vi /etc/ssh/sshd_config
```

![](./img/Crontabimg/3.png)

```
systemctl restart sshd
```


: Clientμ—μ„μ μ‘μ—…(μ ‘μ†μ„ ν•λ” λ†, 192.168.10.137)

- κ³µκ°ν‚¤μ™€ κ°μΈν‚¤ μƒμ„±
```
ssh-keygen -t rsa
```
![](./img/Crontabimg/4.png)

- μƒμ„±λ κ³µκ°ν‚¤λ¥Ό Serverμ— μ „μ†΅

65λ² yesλ΅ μμ •
```
PermitEmptyPasswords no
65λ² PasswordAuthentication yes
```
```
[samadal@localhost .ssh]$ scp id_rsa.pub samadal@192.168.10.132:/export/home/samadal/.ssh/authorized_keys
samadal@192.168.10.132's password:
Permission denied, please try again.
samadal@192.168.10.132's password:
Permission denied, please try again.
samadal@192.168.10.132's password:
id_rsa.pub                                                                                      100%  411   713.7KB/s   00:00
[samadal@localhost .ssh]$

```
![](./img/Crontabimg/5.png)
![](./img/Crontabimg/6.png)


## with keyGen

ν‚¤ μƒμ„±(Host OS)

![](./img/Crontabimg/7.png)
<br>
![](./img/Crontabimg/8.png)
<br>
![](./img/Crontabimg/9.png)

κ³µμ©ν‚¤ μ „μ†΅

pwd: /export/home/samadal/.ssh
```
vi authorized_keys
```
![](./img/Crontabimg/10.png)
<br>

![](./img/Crontabimg/11.png)
<br>
μ„λ²„μ—μ„ ν™•μΈ
![](./img/Crontabimg/12.png)
<br>
![](./img/Crontabimg/13.png)
<br>
![](./img/Crontabimg/14.png)
<br>
λ‹¤μ‹ 65λ² no 
![](./img/Crontabimg/15.png)
<br>
![](./img/Crontabimg/16.png)
600μΌλ΅ μμ •
authorized_keys
<br>
![](./img/Crontabimg/17.png)
<br>
























## μ‹¤μµ 2. μ‘μ©
μμ  1. λ‹¤μμ μ΅°κ±΄μΌλ΅ μ‘μ—…ν•λ‹¤.
'132λ²' μ‹μ¤ν…μ—μ„ CD-ROMμ„ λ§μ΄νΈ ν• ν›„ mariadbλ΅ μ‹μ‘ν•λ” λ¨λ“  ν¨ν‚¤μ§€λ¥Ό /cloud λ””λ ‰ν„°λ¦¬μ— λ³µμ‚¬ν•λ‹¤.

'137λ²' μ‹μ¤ν…μ '/home/samadal/mariadb.tar.gz'λΌλ” νμΌλ΅ λ³µμ‚¬ν•  κ²ƒ <br>
μ΄ μ‘μ—…μ€ λ§¤μΌ μƒλ²½ 5μ‹ 30λ¶„μ— μ‹¤ν–‰λλ„λ΅ ν•λ‹¤.<br>
λ¨λ“  μ‘μ—…μ€ 'Shell Scripting' μΌλ΅ μ„¤μ •ν•λ‹¤.

![](./img/Crontabimg/1.png)

132<br>

mkdir /cloud
```
cd /export/home/samadal

vi mariadb.sh
```
```
!#/bin/bash

cp -p mariadb*.rpm /cloud
```
