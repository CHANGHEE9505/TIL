### í—¬ë¦„ìœ¼ë¡œ 'Prometheus' ì„¤ì¹˜í•˜ê¸°

- ê°œìš”
    - 'Prometheus'ëŠ” 'Jenkins'ì²˜ëŸ¼ 'Helm' ìœ¼ë¡œ ì‰½ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤. 

#### Step 1. 'Kubernetes'ì— 'Prometheus' ë¥¼ ì„¤ì¹˜í•˜ëŠ”ë° í•„ìš”í•œ ì‚¬ì „ êµ¬ì„±
- 'Helm' ì„¤ì¹˜

![](./img/20250610.img/0029.png)

![](./img/20250610.img/0030.png)

ì˜¤ë¥˜ ë°œìƒ

![](./img/20250610.img/0031.png)

![](./img/20250610.img/0032.png)

```
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
```

![](./img/20250610.img/0033.png)

```
[root@m-k8s ~]# helm
The Kubernetes package manager

Common actions for Helm:

- helm search:    search for charts
- helm pull:      download a chart to your local directory to view
- helm install:   upload the chart to Kubernetes
- helm list:      list releases of charts

...

Use "helm [command] --help" for more information about a command.

```

```
[root@m-k8s ~]# helm version
version.BuildInfo{Version:"v3.18.2", GitCommit:"04cad4610054e5d546aa5c5d9c1b1d5cf68ec1f8", GitTreeState:"clean", GoVersion:"go1.24.3"}
```

![](./img/20250610.img/0034.png)

```
helm repo add edu https://iac-source.github.io/helm-charts
helm repo list
```
![](./img/20250610.img/0035.png)
```
helm repo update
```

![](./img/20250610.img/0036.png)


![](./img/20250610.img/0037.png)

```
vi prometheus-server-preconfig.sh
```

```
[root@m-k8s ~]# ls -l
total 24
-rwx------. 1 root root 11913 Jun 10 17:53 get_helm.sh
-rw-r--r--. 1 root root   352 Jun 10 18:14 nfs-exporter.sh
-rwx------. 1 root root  1181 Jun 10 18:14 prometheus-server-preconfig.sh
-rw-r--r--. 1 root root   427 Jun 10 18:11 prometheus-server-volume.yaml
[root@m-k8s ~]#
[root@m-k8s ~]#
[root@m-k8s ~]# chmod 700 nfs-exporter.sh
[root@m-k8s ~]#
[root@m-k8s ~]# ./nfs-exporter.sh
usage: nfs-exporter.sh <name>
[root@m-k8s ~]#
[root@m-k8s ~]#
[root@m-k8s ~]#
[root@m-k8s ~]#
[root@m-k8s ~]# ./prometheus-server-preconfig.sh
[Step 1/4] Task [Check helm status]
[Step 1/4] ok
[Step 2/4] Task [Check MetalLB status]
[Step 2/4] ok
[Step 3/4] Task [Create NFS directory for prometheus-server]
Created symlink from /etc/systemd/system/multi-user.target.wants/nfs-server.service to /usr/lib/systemd/system/nfs-server.service.
/nfs_shared/prometheus/server created
[Step 3/4] Successfully completed
[Step 4/4] Task [Create PV,PVC for prometheus-server]
persistentvolume/prometheus-server created
persistentvolumeclaim/prometheus-server created
[Step 4/4] Successfully completed
[root@m-k8s ~]#

```

#### Step 2. 'Prometheus Object' ì„¤ì¹˜
- 'Prometheus Object'ë¥¼ êµ¬ì„±í•˜ëŠ” ìš”ì†Œ 3ê°œë¥¼ í™•ì¸í•œë‹¤.
- 'Prometheus Server', 'Node Exporter', 'kube State Metric'

![](./img/20250611.img/0001.png)

```
./prometheus-install.sh
```

#### Step 3. ì„¤ì¹˜ í™•ì¸

![](./img/20250611.img/0002.png)

#### Step 4. ì›¹ UI ì ‘ì†ì´ ë˜ëŠ”ì§€ í™•ì¸

#### Step 5. ì‚¬ì´íŠ¸ ì¶œë ¥

![](./img/20250611.img/0003.png)

### 'Prometheus ì›¹ UI'
#### ì¿¼ë¦¬ ì…ë ¥ê¸°
- 'Prometheus'ê°€ ì ì¬í•œ ë©”íŠ¸ë¦­ ë°ì´í„°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” í‘œí˜„ì‹ì„ ì…ë ¥í•œë‹¤.
- ì´ ë•Œ ì‚¬ìš©í•˜ëŠ” 'í‘œí˜„ì‹'ì€ 'PromQL(Prometheus Query Language)' ì´ë¼ëŠ” 'Prometheus'ì—ì„œ ì œê³µí•˜ëŠ” 'ì¿¼ë¦¬ ì–¸ì–´'ì´ë‹¤. 
- 'Prometheus'ëŠ” 'ì‹œê³„ì—´ ë°ì´í„°ë² ì´ìŠ¤(ì‹œê°„ì˜ íë¦„ì— ë”°ë¥¸ ìµœì ì˜ DB)'ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ 'R-DBMS(ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤, Relationship DataBase Management System)' ì²˜ëŸ¼ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ íš¨ê³¼ì ìœ¼ë¡œ í•„ìš”í•œ 'Metric(ì‹œìŠ¤í…œ ì •ë³´ ì¸¡ì •ê°’)'ì„ ì¶”ì¶œ

### ğŸ”˜ Execute
- `ì¿¼ë¦¬ ì…ë ¥ê¸°`ì— ì…ë ¥í•œ **PromQL**ì„ ì‹¤í–‰í•˜ëŠ” ë²„íŠ¼ì…ë‹ˆë‹¤.
- ì´ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ **PromQL í‘œí˜„ì‹ì— ë§ëŠ” ë©”íŠ¸ë¦­ ë°ì´í„°**ë¥¼ í™”ë©´ì— ë³´ì—¬ì¤ë‹ˆë‹¤.

### ğŸ“Š Graph
- **Prometheus**ê°€ ìˆ˜ì§‘í•œ ë©”íŠ¸ë¦­ ë°ì´í„°ë¥¼ **ì‹œê°ì ìœ¼ë¡œ í‘œí˜„**í•´ì£¼ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤.
- `Graph` íƒ­ì„ í´ë¦­í•˜ë©´ **ì˜ì—­í˜• ë˜ëŠ” ë§‰ëŒ€í˜• ì°¨íŠ¸**ë¡œ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ“‹ Console
- **PromQL**ë¡œ ì¶”ì¶œëœ ë©”íŠ¸ë¦­ ë°ì´í„°ë¥¼ **í‘œ í˜•ì‹ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ê¸°ë³¸ ì˜µì…˜**ì…ë‹ˆë‹¤.
- ê°œë³„ ë°ì´í„°ë¥¼ ì„¸ë¶€ì ìœ¼ë¡œ í™•ì¸í•˜ê¸°ì— ìœ ìš©í•©ë‹ˆë‹¤.

### â• Add Graph
- ê·¸ë˜í”„ ì¶”ê°€ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” **ì¿¼ë¦¬ ì…ë ¥ê¸°**ë¥¼ í•˜ë‚˜ ë” ì¶”ê°€í•´ **ë˜ ë‹¤ë¥¸ ë©”íŠ¸ë¦­**ì„ í™•ì¸í•˜ëŠ” ë²„íŠ¼ì…ë‹ˆë‹¤.

### â– Remove Graph
- í˜„ì¬ **ì¿¼ë¦¬ ì…ë ¥ê¸°**ë¥¼ ì œê±°í•˜ëŠ” ë²„íŠ¼ì…ë‹ˆë‹¤.

## Service Discovery (ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬)

### ê°œìš”
- 'Prometheus'ëŠ” ìˆ˜ì§‘ ëŒ€ìƒì„ ìë™ìœ¼ë¡œ ì¸ì‹í•˜ê³  í•„ìš”í•œ ì •ë³´ë¥¼ ìˆ˜ì§‘í•œë‹¤..
- ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ë ¤ë©´ ì¼ë°˜ì ìœ¼ë¡œ 'Agent(ì „ìš© í”„ë¡œê·¸ë¨ ë˜ëŠ” ì „ìš© íˆ´)'ë¥¼ ì„¤ì •í•´ì•¼ í•˜ì§€ë§Œ 'Kubernetes'ëŠ” ì‚¬ìš©ìê°€ 'Agent'ì— ì¶”ê°€ë¡œ ì…ë ¥í•  í•„ìš”ì—†ì´ ìë™ìœ¼ë¡œ 'Metric'ì„ ìˆ˜ì§‘í•  ìˆ˜ ìˆë‹¤.
- 'ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬'ë¼ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•˜ë ¤ë©´ 'Prometheus Server'ê°€ ìˆ˜ì§‘ ëŒ€ìƒì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

### 'ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬' ì‘ë™ ìˆœì„œ
- 'Prometheus Server'ëŠ” 'ConfigMap'ì— ê¸°ë¡ëœ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ëŒ€ìƒì„ ì½ì–´ì˜¨ë‹¤. 
- ì½ì–´ì˜¨ ëŒ€ìƒì— ëŒ€í•œ Metricì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ 'API' ì„œë²„ì— ì •ë³´ë¥¼ ìš”ì²­í•œë‹¤.
- ìš”ì²­ì„ í†µí•´ ì•Œì•„ì˜¨ ê²½ë¡œë¡œ Metric ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•œë‹¤.
- ì´ì™€ ê°™ì€ ìˆœì„œë¡œ 'Prometheus Server'ì™€ 'API Server'ê°€ ì£¼ê¸°ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì•„ì„œ ìˆ˜ì§‘ ëŒ€ìƒì„ ì—…ë°ì´íŠ¸í•˜ê³  ìˆ˜ì§‘ ëŒ€ìƒì—ì„œ ê³µê°œë˜ëŠ” 'Metric'ì„ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•œë‹¤.

## ğŸ’¡ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ë€?
> Prometheusê°€ **ìë™ìœ¼ë¡œ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ëŒ€ìƒ**ì„ ì°¾ì•„ì„œ ë“±ë¡í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.  
ëŒ€ìƒì€ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ Pod, Node, Exporter ë“±ì¼ ìˆ˜ ìˆê³ , ì´ë¥¼ í†µí•´ ìˆ˜ì‘ì—… ì—†ì´ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ëŒ€ìƒì´ ìë™ ê°±ì‹ ë©ë‹ˆë‹¤.

---

## ğŸ¯ ëŒ€ìƒì— ë”°ë¥¸ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ë°©ì‹

### ğŸ”¹ cAdvisor ë°©ì‹
- `cAdvisor`ëŠ” **ì»¨í…Œì´ë„ˆ ë‹¨ìœ„ì˜ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ (CPU, ë©”ëª¨ë¦¬, ë„¤íŠ¸ì›Œí¬ ë“±)** ì„ ìˆ˜ì§‘í•´ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
- **Kubernetesì˜ API Serverì™€ ì§ì ‘ ì—°ê²°**ë˜ì–´ ë™ì‘í•©ë‹ˆë‹¤.
- `Prometheus`ëŠ” `API Server`ë¥¼ í†µí•´ ê° ë…¸ë“œì— ìˆëŠ” `cAdvisor`ì˜ ì£¼ì†Œë¥¼ **ìë™ìœ¼ë¡œ ë””ìŠ¤ì»¤ë²„ë¦¬**í•©ë‹ˆë‹¤.
- ì´ë ‡ê²Œ ë˜ë©´ Prometheusê°€ ê° ë…¸ë“œì˜ cAdvisor ì—”ë“œí¬ì¸íŠ¸ë¡œë¶€í„° **ë©”íŠ¸ë¦­ì„ ìë™ìœ¼ë¡œ ìˆ˜ì§‘**í•˜ê²Œ ë©ë‹ˆë‹¤.

> ğŸ” **íë¦„**:  
Prometheus â† API Server (ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬) â† cAdvisor (ë…¸ë“œë‹¹ ì‹¤í–‰)

---

### ğŸ”¹ Agent ë°©ì‹
- ì—¬ê¸°ì„œ ë§í•˜ëŠ” `Agent`ëŠ” Prometheus í™˜ê²½ì—ì„œ **Exporter** ì—­í• ì„ í•©ë‹ˆë‹¤. ì˜ˆ: Node Exporter, MySQL Exporter ë“±
- ì´ Exporter(Agent)ëŠ” **ì§ì ‘ API Serverì— ë“±ë¡ë˜ì§€ëŠ” ì•ŠìŒ**.
- ëŒ€ì‹  **API Serverê°€ Exporterê°€ ìˆëŠ” ìœ„ì¹˜(ì£¼ì†Œ, í¬íŠ¸)ë¥¼ Prometheusì—ê²Œ ì•Œë ¤ì¤Œ**.
- PrometheusëŠ” ì´ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ Exporterì—ì„œ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•©ë‹ˆë‹¤.

> ğŸ” **íë¦„**:  
Prometheus â† API Server (ë””ìŠ¤ì»¤ë²„ë¦¬ ì •ë³´ ì œê³µ) â†’ Exporter (Agent)

---

## âœ… ì¶”ê°€ ì„¤ëª…: Prometheusì™€ API Server

- PrometheusëŠ” `kubernetes_sd_configs` ê°™ì€ ì„¤ì •ìœ¼ë¡œ **API Serverì™€ ì—°ê²°**ë˜ì–´ì„œ ê°ì¢… ëŒ€ìƒ ì •ë³´ë¥¼ ìˆ˜ì‹ í•©ë‹ˆë‹¤.
- ì´ ì •ë³´ì—ëŠ” Pod, Node, Service, Endpoints ë“±ì´ í¬í•¨ë©ë‹ˆë‹¤.
- ì´ê±¸ ë°”íƒ•ìœ¼ë¡œ cAdvisorë‚˜ Agent(Exporter)ë¥¼ ìë™ ê°ì§€í•´ ëª¨ë‹ˆí„°ë§í•˜ê²Œ ë˜ëŠ” ê±°ì£ .

---

## ğŸ“Œ ìš”ì•½ ë¹„êµ

| êµ¬ë¶„ | ì—°ê²° ë°©ì‹ | ì—­í•  | ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ê²½ë¡œ |
|------|------------|------|------------------|
| cAdvisor | API Serverì— ì§ì ‘ ì—°ê²°ë¨ | ë…¸ë“œ ë‹¨ìœ„ ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ìˆ˜ì§‘ | API Server â†’ Prometheus |
| Agent (Exporter) | API Serverê°€ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì¤Œ | ì•±/ì‹œìŠ¤í…œ ë‹¨ìœ„ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ | Exporter ì§ì ‘ ì—°ê²° (ì£¼ì†Œ ì œê³µë°›ìŒ) |

## ì‹¤ìŠµ
### Step 1. 

- 'Prometheus' 'ì›¹ UI'ë¡œ ê°„ë‹¤.
- 'cAdvisor'ë¡œ ìˆ˜ì§‘ëœ 'Metric'ì€ 'container' ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì‹œì‘í•˜ëŠ”ë° 'ì¿¼ë¦¬ ì…ë ¥ê¸°'ì— 'container_memory_usage_bytes' ë¥¼ ì…ë ¥í•˜ê³  'Excute'ë¥¼ í´ë¦­

![](./img/20250611.img/0004.png)

![](./img/20250611.img/0005.png)

-  ìš°ì¸¡ ìƒë‹¨ì— ìˆëŠ” 3ê°€ì§€

```
Load time: 16ms ('PromQL'ì´ ë™ì‘í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì´ë‹¤. ë‹¨ìœ„ëŠ” 'ms')
Resolution: 28s (ìˆ˜ì§‘ëœ ë°ì´í„°ë¡œ ì €ì¥ëœ ì´ˆ ë‹¨ìœ„ì˜ ê·¸ë˜í”„ë¥¼ ê·¸ë¦°ë‹¤.)
Total time series: 106 ('PromQL'ë¡œ ìˆ˜ì§‘ëœ ê²°ê³¼ì˜ ê°¯ìˆ˜ì´ë‹¤.)
```
### Step 2. ë ˆì´ë¸” ì¶”ê°€
- ìƒˆë¡œ Deploymentë¥¼ ì¶”ê°€í•˜ë©´ ìë™ìœ¼ë¡œ Metricì„ ìˆ˜ì§‘í•˜ëŠ”ì§€ í™•ì¸í•´ ë³¸ë‹¤.
- 'PromQL' ë¬¸ì— ì¶”ê°€í•  'Pod'ì˜ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•  ìˆ˜ ìˆë„ë¡ {container="nginx"}ë¥¼ ì¶”ê°€í•˜ê³  'Excute'ë¥¼ í´ë¦­í•œë‹¤.
- ì´ëŸ° êµ¬ë¶„ì„ 'ë ˆì´ë¸”' ì´ë¼ê³  í•˜ëŠ”ë° 'PromQL' ì—ì„œ í•„ìš”í•œ ë‚´ìš©ì„ ì¶”ì¶œí•  ë•Œ ì‚¬ìš©í•œë‹¤.
- í˜„ì¬ 'nginx Deployment'ê°€ ì„¤ì¹˜ê°€ ë˜ì–´ ìˆì§€ ì•Šì€ ìƒíƒœì´ê¸° ë•Œë¬¸ì— 'no data'ë¼ê³  ë‚˜ì˜¨ë‹¤.

### Step 3. 'Master Node(m-k8s)'ì—ì„œ 'nginx Deployment'ë¥¼ ë°°í¬í•œë‹¤.

![](./img/20250611.img/0006.png)

![](./img/20250611.img/0007.png)

```
    56        job_name: kubernetes-nodes-cadvisor
    57        kubernetes_sd_configs:
    58        - role: node
    59        relabel_configs:
    60        - action: labelmap
    61          regex: __meta_kubernetes_node_label_(.+)
    62        - replacement: kubernetes.default.svc:443
    63          target_label: __address__
    64        - regex: (.+)
    65          replacement: /api/v1/nodes/$1/proxy/metrics/cadvisor
    66          source_labels:
    67          - __meta_kubernetes_node_name
    68          target_label: __metrics_path__

```

![](./img/20250611.img/0008.png)

### Step 4. 'ì›¹ UI'ì˜ í•˜ë‹¨ì—ì„œ 'nginx Deployment'ì— ëŒ€í•œ 'Metric'ì´ ìë™ìœ¼ë¡œ ìˆ˜ì§‘ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

### Step 5. 'nginx Deployment'ë¥¼ ì‚­ì œí•˜ê³  ë” ì´ìƒ 'Metric'ì´ ìë™ìœ¼ë¡œ ìˆ˜ì§‘ë˜ì§€ ì•Šë„ë¡ í•œë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ 'ì›¹ UI'ì˜ í•˜ë‹¨ì— 'no data'ë¥¼ í™•ì¸í•˜ë©´ ëœë‹¤.

![](./img/20250611.img/0009.png)

![](./img/20250611.img/0010.png)

## ì •ë¦¬

# âœ… 1. Kustomizeë¥¼ ì´ìš©í•œ MetalLB ë°°í¬ ìë™í™”

## ğŸ”§ ì¤€ë¹„ íŒŒì¼ í™•ì¸
```bash
ls -l

-rw-r--r--. 1 root root  250 Jun 11 12:55 kustomization.yaml
-rwx------. 1 root root  261 Jun 11 12:37 kustomize-install.sh
-rw-r--r--. 1 root root  223 Jun 11 12:37 metallb-l2config.yaml
-rw-r--r--. 1 root root 5384 Jun 11 12:37 metallb.yaml
-rw-r--r--. 1 root root   90 Jun 11 12:37 namespace.yaml

```
â†’ `kustomization.yaml`, MetalLB ê´€ë ¨ ë¦¬ì†ŒìŠ¤ yaml, ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ ìˆëŠ”ì§€ í™•ì¸

## ğŸ› ï¸ kustomize ì„¤ì • ìƒì„± ë° í™•ì¸
```bash
./kustomize-install.sh
kustomize create --namespace=metallb-system --resources namespace.yaml,metallb.yaml,metallb-l2config.yaml

cat kustomization.yaml
vi kustomization.yaml
```
â†’ MetalLB êµ¬ì„± ë¦¬ì†ŒìŠ¤ë¥¼ í•˜ë‚˜ë¡œ ë¬¶ëŠ” `kustomization.yaml` ìƒì„± ë° í™•ì¸/í¸ì§‘

## ğŸ“¦ kustomization.yaml ë‚´ìš© ì˜ˆì‹œ
```yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- namespace.yaml                -ì¶”ê°€
- metallb.yaml                  -ì¶”ê°€
- metallb-l2config.yaml         -ì¶”ê°€
namespace: metallb-system
images:
- name: metallb/controller
  newTag: v0.8.2
- name: metallb/speaker
  newTag: v0.8.2
```

## ğŸ—ï¸ ë¹Œë“œ ë° ì ìš©
```bash
kustomize edit set image metallb/controller:v0.8.2
kustomize edit set image metallb/speaker:v0.8.2
kustomize build | kubectl apply -f -
```

## âœ… ìƒíƒœ í™•ì¸
```bash
kubectl get pods -n metallb-system
kubectl get configmap -n metallb-system
kubectl describe pods -n metallb-system | grep Image:
```

## ğŸŒ í…ŒìŠ¤íŠ¸ ì„œë¹„ìŠ¤ ë°°í¬
```bash
kubectl create deployment echo-ip --image=sysnet4adin/echo-ip
kubectl expose deployment echo-ip --type=LoadBalancer --port=80
kubectl get service echo-ip
```

## ğŸ§¹ ì •ë¦¬
```bash
kustomize build | kubectl delete -f -
kubectl delete service echo-ip
kubectl delete deployment echo-ip
```

---

# âœ… 2. Helmì„ ì´ìš©í•œ MetalLB ë°°í¬ ìë™í™”

## ğŸ“¥ Helm ì„¤ì¹˜ (ìŠ¤í¬ë¦½íŠ¸ ë‹¤ìš´ë¡œë“œ ë° ì‹¤í–‰)
```bash
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
```

## ğŸ“¦ Helm ì°¨íŠ¸ ì €ì¥ì†Œ ì¶”ê°€ ë° ì—…ë°ì´íŠ¸
```bash
helm repo add edu https://iac-source.github.io/helm-charts
helm repo list
helm repo update
```

## ğŸš€ MetalLB ì„¤ì¹˜
```bash
helm install metallb edu/metallb \
--namespace=metallb-system \
--create-namespace \
--set controller.tag=v0.8.3 \
--set speaker.tag=v0.8.3 \
--set configmap.ipRange=192.168.1.11-192.168.1.29
```

## âœ… ìƒíƒœ í™•ì¸ ë° í…ŒìŠ¤íŠ¸ ì„œë¹„ìŠ¤ ë°°í¬
```bash
kubectl get pods -n metallb-system
kubectl create deployment echo-ip --image=sysnet4adin/echo-ip
kubectl expose deployment echo-ip --type=LoadBalancer --port=80
kubectl get service echo-ip
```

## ğŸ§¹ ì •ë¦¬
```bash
kubectl delete service echo-ip
kubectl delete deployment echo-ip
```

---

# âœ… 3. Prometheus ì„¤ì¹˜

```
ls -l
-rwx------. 1 root root  352 Jun 11 12:37 nfs-exporter.sh
-rwx------. 1 root root  564 Jun 11 12:37 prometheus-install.sh
-rwx------. 1 root root 1229 Jun 11 12:37 prometheus-server-preconfig.sh
-rw-r--r--. 1 root root  427 Jun 11 12:37 prometheus-server-volume.yaml

```

## ğŸ› ï¸ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
```bash
./prometheus-server-preconfig.sh
./prometheus-install.sh
```

## âœ… Prometheus ìƒíƒœ í™•ì¸
```bash
kubectl get pods --selector=app=prometheus
kubectl get service prometheus-server
```

## ğŸŒ ì›¹ UI í…ŒìŠ¤íŠ¸ìš© NGINX ë°°í¬
```bash
kubectl create deployment nginx --image=nginx
```

â†’ ì´í›„ Prometheus ì›¹ UIì— ì ‘ì†í•˜ì—¬ NGINX ë“± ëª¨ë‹ˆí„°ë§ ëŒ€ìƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ

ì¿¼ë¦¬ ì…ë ¥ê¸°ì— 'container_memory_usage_bytes{container="nginx"} dlqfur

'Excute'í´ë¦­í•˜ê³  ì•½ 1ë¶„ ~ 2ë¶„ ê·¸ëƒ¥ ê¸°ë‹¤ë¦°ë‹¤.
'Element' í•˜ë‹¨ì— ì¿¼ë¦¬ì— ëŒ€í•œ ì‘ë‹µì´ ì¶œë ¥ëœë‹¤.
