# ì¿ ë²„ë„¤í‹°ìŠ¤

## 1. ì¸í”„ë¼ í™˜ê²½(Infrastructure Configuration)ì˜ ì´í•´

### ì˜¨í”„ë ˆë¯¸ìŠ¤(on-premises)
 - **ê¸°ì—… ë‚´ì— ìˆëŠ” ì „ì‚°ì‹¤(ê¸°ì—… ì „ìš©ì„ , ë™, ì„œë²„ ë“±)** ë“±ì„ ë§í•œë‹¤.
 - ì—”ì§€ë‹ˆì–´ê°€ ê°œë°œ í™˜ê²½ì„ ë§Œë“¤ì–´ì„œ ì œê³µí•˜ë©´ ì‚¬ìš©ìëŠ” ê·¸ì— ë§ëŠ” ë„êµ¬ë¥¼ ëª¨ë‘ ì„¤ì¹˜í•˜ê³  ì‚¬ìš©í•˜ëŠ” í™˜ê²½ì„ ë§í•œë‹¤.



 ### ì„œë¹„ìŠ¤ë¡œì„œì˜ ì¸í”„ë¼ í™˜ê²½(IaaS, Infrastructure as a Service)

 - ëˆì„ ë„£ìœ¼ë©´ ìíŒê¸°ì—ì„œ ë¯¸ë¦¬ ì¤€ë¹„ëœ ìƒí’ˆ(ìŒë£Œ ë“±)ì´ ë‚˜ì˜¤ë“¯ì´ ë¯¸ë¦¬ êµ¬ì„±ëœ í™˜ê²½ì„ ì‚¬ìš©ìê°€ í•„ìš”ì— ë”°ë¼ ì„ íƒí•˜ê³  ì¡°í•©í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ë§í•œë‹¤.

- ì• ìì¼
: ê³„íš ë‹¨ê³„ì—ì„œ ì„¤ê³„ì™€ã…í™˜ê²½ì„ ì™„ì „í•˜ê²Œ êµ¬ë¹„í•œ í›„ ì˜ˆì •ëœ ëª©í‘œë¥¼ ë‹¬ì„±í•´ ë‚˜ê°€ëŠ” ê²ƒ

## 2. 'Kubenetes(k8s)' ê°œìš”

- ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ì€ ì»¨í…Œì´ë„ˆë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ëœ ì¸í”„ë¼ í™˜ê²½ì„ ë§í•œë‹¤.
- ì»¨í…Œì´ë„ˆëŠ” í•˜ë‚˜ì˜ ìš´ì˜ì²´ì œ ì»¤ë„ì—ì„œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— ì˜í–¥ì„ ë°›ì§€ ì•Šê³  (í•µì‹¬)ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” í”„ë¡œì„¸ìŠ¤ ìƒíƒœë¥¼ ë§í•œë‹¤.
- CICëŠ” í¬ê²Œ ì»¨í…Œì´ë„ˆ ê´€ë¦¬, ê°œë°œ í™˜ê²½ êµ¬ì„± ë° ë°°í¬ ìë™í™”, ëª¨ë‹ˆí„°ë§ ë“±ìœ¼ë¡œ êµ¬ì„±ëœë‹¤.

## 3. CIC ì§€ì›ë„êµ¬
- ì»¨í…Œì´ë„ˆ
    - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤í–‰ í™˜ê²½ì„ í¬í•¨í•˜ëŠ” ê°€ë²¼ìš´ íŒ¨í‚¤ì§€
- ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„
    - ì»¨í…Œì´ë„ˆ ì‹¤í–‰ì„ ë‹´ë‹¹í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë§í•œë‹¤.
- ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
    - êµ¬ì„±ê³¼ ë°°í•©ì„ ì ìš©í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.
    - ì»¨í…Œì´ë„ˆì˜ ê´€ë¦¬, ë°°í¬, í™•ì¥ê³¼ ê°™ì€ ì„œë¹„ìŠ¤ ì „ë°˜ì— ê±¸ì³ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.
    - ì»¨í…Œì´ë„ˆ í†µí•© ê´€ë¦¬ ë¥¼ í•œë‹¤.
- ë„ì»¤
- ì¿ ë²„ë„¤í‹°ìŠ¤
    - ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì„ í†µí•´ 'ì»¨í…Œì´ë„ˆë¥¼ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜' í•˜ëŠ” ë„êµ¬ë¥¼ ë§í•œë‹¤.
- ì  í‚¨ìŠ¤
    - ê°œë°œí•œ í”„ë¡œê·¸ë¨ì˜ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, íŒ¨í‚¤ì§€í™”. ë°°í¬ ë‹¨ê³„ë¥¼ ëª¨ë‘ **ìë™í™”** í•˜ëŠ” ì¦‰, ê°œë°œ ë‹¨ê³„ë¥¼ í‘œì¤€í™”í•˜ê³  ìˆëŠ” ê²ƒì„ ë§í•œë‹¤.
- Prometheus & Grafana
    - GUI Mode í˜•íƒœì˜ ëª¨ë‹ˆí„°ë§ ë„êµ¬ë¥¼ ë§í•œë‹¤.
- API(Application Programming Interface, ì‘ìš© í”„ë¡œê·¸ë˜ë° ì¸í„°í˜ì´ìŠ¤)
    - ì»´í“¨í„°(Hardware)ì™€ ì»´í“¨í„° í”„ë¡œê·¸ë¨(software) ì‚¬ì´ì˜ ì—°ê²°ì„ ë§í•œë‹¤.
    - ë¦¬ëˆ…ìŠ¤ ì‹œìŠ¤í…œì—ì„œì˜ 'Mount'ì™€ ìœ ì‚¬í•œ ê¸°ëŠ¥ì´ë‹¤.

## 4. ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ í™˜ê²½ ì¢…ë¥˜
### ëª¨ë†€ë¦¬ì‹ ì•„í‚¤í…ì²˜(Monolithic Architecture)

#### ê°œìš”

- í•˜ë‚˜ì˜ í° ëª©ì ì´ ìˆëŠ” ì„œë¹„ìŠ¤ ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì—¬ëŸ¬ ê¸°ëŠ¥ì´ 'í†µí•©' ë˜ì–´ ìˆëŠ” êµ¬ì¡°ë¥¼ ë§í•œë‹¤.

#### ì¥ì 

- ê°œë°œì´ ë‹¨ìˆœí•˜ë‹¤.
- ì½”ë“œ ê´€ë¦¬ê°€ ë¹„êµì  ê°„í¸í•˜ë‹¤.

#### ë‹¨ì 

- ìˆ˜ì •ì´ ë§ì„ ê²½ìš° ì—°ê´€ëœ ì„œë¹„ìŠ¤ ë“±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´ ë†’ì•„ì§„ë‹¤.
- ì„œë¹„ìŠ¤ì™€ ê´€ë ¨ëœ ê¸°ëŠ¥ë“¤ì´ ë§ì•„ì§ˆìˆ˜ë¡ ì„œë¹„ìŠ¤ ê°„ì˜ ê´€ê³„ê°€ ë³µì¡í•´ì§„ë‹¤.


### ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜(MicroServices Architecture)
#### ê°œìš”

- MAì™€ ê°™ì´ ì‹œìŠ¤í…œ ì „ì²´ê°€ í•˜ë‚˜ì˜ ëª©ì ì„ ì§€í–¥í•˜ì§€ë§Œ 'ê°œë³„ ê¸°ëŠ¥'ì„ í•˜ëŠ” ì‘ì€ ì„œë¹„ìŠ¤ë¥¼ ê°ê° ê°œë°œí•´ì„œ 'ì—°ê²°'í•˜ëŠ” êµ¬ì¡°ë¥¼ í•˜ê³  ìˆë‹¤.

#### ì¥ì 

- ê°œë°œëœ ì„œë¹„ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ê¸°ì— ìš©ì´í•˜ë‹¤.
- ì„œë¹„ìŠ¤ ë³€ê²½ ì‹œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹  ê°€ëŠ¥ì„±ì´ ë‚®ë‹¤.
- ì‚¬ìš©ìì˜ ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ ê°€ìš©ì„±ì„ ì¦‰ê°ì ìœ¼ë¡œ í™•ë³´í•´ì•¼ í•˜ëŠ” IaaS í™˜ê²½ì— ì í•©í•˜ë‹¤.

#### ë‹¨ì 

- ì„œë¹„ìŠ¤ê°€ ë§ì„ìˆ˜ë¡ ë³µì¡ë„ê°€ ë†’ì•„ì§„ë‹¤.
- ì‚¬ìš©í•˜ëŠ” ëŸ‰ì´ ì¦ê°€í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ê°€ ìˆë‹¤.

# 5. Kubebetes ì‹¤ìŠµí™˜ê²½

## ğŸ§ª Kubernetes ì‹¤ìŠµ í™˜ê²½ êµ¬ì„±

### ğŸ–¥ï¸ Virtualization
- **ê°€ìƒí™” ë„êµ¬**: Oracle VirtualBox

### ğŸ’» Host OS
- **ìš´ì˜ì²´ì œ**: Ubuntu 24.04 Desktop

### ğŸ³ Container
- **ì»¨í…Œì´ë„ˆ ë„êµ¬**: Docker
- **Runtime**: containerd

### â˜¸ï¸ Kubernetes
- **ë²„ì „**: Kubernetes 1.28 â†’ 1.29 ì—…ê·¸ë ˆì´ë“œ ì‹¤ìŠµ í¬í•¨

### ğŸ–§ Cluster êµ¬ì„±
- **ì´ ë…¸ë“œ ìˆ˜**: 3ê°œ
  - ğŸŸ© **Control Plane (Master Node)**: 1ê°œ
  - ğŸŸ¦ **Worker Node**: 2ê°œ

# 6. 'Vagrant'ë¥¼ ì´ìš©í•œ Ansible ì‹¤ìŠµ í™˜ê²½ êµ¬ì„± ë° í…ŒìŠ¤íŠ¸

## ë§¤ìš° ì¤‘ìš”
- ê°€ìƒ ë¨¸ì‹ ì„ ì„¤ì¹˜í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— **VMWare**ì—ì„œì˜ **ê°€ìƒ í™˜ê²½**ì´ ì•„ë‹Œ 'Main Host System(OS, Windows 10)'ì— ì„¤ì¹˜í•´ì•¼ í•œë‹¤.
- 'Provisioning(ê³µê¸‰)'ì— í•„ìš”í•œ ê¸°ë³¸ ì½”ë“œì¸ 'Vagrant Script File(Vagrantfile)'ì„ í¸ì§‘í•  ë•ŒëŠ” ì ˆëŒ€ 'Tab'í‚¤ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ê³  'Space Bar'ë¥¼ ì´ìš©í•´ì•¼ í•œë‹¤.

## ê°œìš”
- 'Vagrant'ëŠ” ì‚¬ìš©ìì˜ ìš”êµ¬ì— ë§ê²Œ ì‹œìŠ¤í…œ ìì›ì„ í• ë‹¹, ë°°ì¹˜í•´ ë‘ì—ˆë‹¤ê°€í•„ìš”í•  ë•Œì— ì‹œìŠ¤í…œì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìƒíƒœë¡œ ë§Œë“¤ì–´ ì£¼ëŠ”ë° ì´ë¥¼ 'Provisioning' ì´ë¼ê³  í•œë‹¤. ì¦‰, **í•„ìš”í•  ë•Œ ê³µê¸‰í•œë‹¤** ë¼ëŠ” ë§ì´ë‹¤.
- VMWare ë˜ëŠ” VirtualBoxì—ì„œ OSë¥¼ ì„¤ì¹˜í•˜ê³  êµ¬ì„±í•œ ì´í›„ì— ë³µì œí•˜ëŠ” ë“±ì˜ ê³¼ì •ì´ í•„ìš” ì—†ê²Œ ëœë‹¤.

## [Vagrant ëª…ë ¹ì–´](https://github.com/CHANGHEE9505/TIL/blob/main/ANsible/20250519Vagrant.md)

## Vagrant ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜

## Vagrant êµ¬ì„± í›„ í…ŒìŠ¤íŠ¸
### Step 1. í”„ë¡œë¹„ì €ë‹ì— í•„ìš”í•œ ê¸°ë³¸ ì½”ë“œì¸ 'Vagrantfile' ìƒì„±
```
C:\HashiCorp> vagrant init
==> vagrant: A new version of Vagrant is available: 2.4.6 (installed version: 2.4.5)!
==> vagrant: To upgrade visit: https://www.vagrantup.com/downloads.html

`Vagrantfile` already exists in this directory. Remove it before
running `vagrant init`.

C:\HashiCorp>vagrant --version
Vagrant 2.4.5

C:\HashiCorp>vagrant init
`Vagrantfile` already exists in this directory. Remove it before
running `vagrant init`.
```

![](./img/20250530.img/0001.png)

### Step 2. 'Vagrantfile' íŒŒì¼ì˜ ë‚´ìš©ì„ í™•ì¸
### Step 3. í”„ë¡œë¹„ì €ë‹ ì‘ì—… (ì˜¤ë¥˜ ë°œìƒ)

![](./img/20250530.img/0002.png)

### Step 4. 'OS Image' ì„ íƒ

### Step 5. Vagrantfile íŒŒì¼ì˜ ë‚´ìš©ì„ ìˆ˜ì •
![](./img/20250530.img/0003.png)

### Step 6. 'OS Image' ë‹¤ìš´ë¡œë“œ í™•ì¸
![](./img/20250530.img/0005.png)
### Step 7. ê°€ìƒ ë¨¸ì‹ ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  SSH.ë¥¼ ì´ìš©í•œ ì›ê²© ì ‘ì†

![](./img/20250530.img/0006.png)

### Step 8. ì„¤ì¹˜ê°€ ì •ìƒì ìœ¼ë¡œ ë˜ì—ˆëŠ”ì§€ í™•ì¸
![](./img/20250530.img/0004.png)

### Step 9. ì œê±°
![](./img/20250530.img/0007.png)
![](./img/20250530.img/0008.png)

## 'Vagrant File'ì„ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì¶•

- ê°€ìƒ ë¨¸ì‹ ì— í•„ìš”í•œ ì„¤ì • ë“±ì„ íŒŒì¼ì„ ì´ìš©í•´ì„œ ìë™ìœ¼ë¡œ ì ìš©ë˜ëŠ” ê°€ìƒ ë¨¸ì‹  ìƒì„±

```
# -*- mode: ruby -*-
# vi: set ft=ruby :
Vagrant.configure("2") do |config| 
  config.vm.define "m-k8s" do |cfg|
    cfg.vm.box = "sysnet4admin/CentOS-k8s"
    cfg.vm.provider "virtualbox" do |vb|
      vb.name = "m-k8s(github_SysNet4Admin)"
      vb.cpus = 2
      vb.memory = 2048
      vb.customize ["modifyvm", :id, "--groups", "/k8s-SM(github_SysNet4Admin)"]
    end
    cfg.vm.host_name = "m-k8s"
    cfg.vm.network "private_network", ip: "192.168.1.10"
    cfg.vm.network "forwarded_port", guest: 22, host: 60010, auto_correct: true, id: "ssh"
    cfg.vm.synced_folder "../data", "/vagrant", disabled: true
  end
end
```

![](./img/20250530.img/0010.png)

![](./img/20250530.img/0011.png)

![](./img/20250530.img/0012.png)

![](./img/20250530.img/0013.png)

## ë‹¤ìŒ

![](./img/20250530.img/0014.png)

install_pkg.sh
```
#!/usr/bin/env bash

# install packages 
yum install epel-release -y
```
ping_2_nds.sh
```
# ping 3 times per nodes
ping 192.168.1.101 -c 3
ping 192.168.1.102 -c 3
ping 192.168.1.103 -c 3
```
config.sh
```
#!/usr/bin/env bash
# modify permission  
chmod 744 ./ping_2_nds.sh
```

Vagrantfile
```
# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config| 
  config.vm.define "m-k8s" do |cfg|
    cfg.vm.box = "rockylinux/9"
    cfg.vm.provider "virtualbox" do |vb|
      vb.name = "m-k8s(clouddx_rockylinux9)"
      vb.cpus = 2
      vb.memory = 2048
      vb.customize ["modifyvm", :id, "--groups", "/k8s-SM(clouddx_rockylinux9)"]
    end
    cfg.vm.host_name = "m-k8s"
    cfg.vm.network "private_network", ip: "192.168.1.10"
    cfg.vm.network "forwarded_port", guest: 22, host: 60010, auto_correct: true, id: "ssh"
    cfg.vm.synced_folder "../data", "/vagrant", disabled: true   
    cfg.vm.provision "shell", path: "install_pkg.sh"
    cfg.vm.provision "file", source: "ping_2_nds.sh", destination: "ping_2_nds.sh"
    cfg.vm.provision "shell", path: "config.sh"
  end
  
  #=============#
  # Added Nodes #
  #=============#

  (1..3).each do |i|
    config.vm.define "w#{i}-k8s" do |cfg|
      cfg.vm.box = "rockylinux/9"
      cfg.vm.provider "virtualbox" do |vb|
        vb.name = "w#{i}-k8s(clouddx_rockylinux9)"
        vb.cpus = 1
        vb.memory = 1024
        vb.customize ["modifyvm", :id, "--groups", "/k8s-SM(clouddx_rockylinux9)"]
      end
      cfg.vm.host_name = "w#{i}-k8s"
      cfg.vm.network "private_network", ip: "192.168.1.10#{i}"
      cfg.vm.network "forwarded_port", guest: 22, host: "6010#{i}",auto_correct: true, id: "ssh"
      cfg.vm.synced_folder "../data", "/vagrant", disabled: true
      cfg.vm.provision "shell", path: "install_pkg.sh"
    end
  end
end
```
![](./img/20250530.img/0015.png)

```
vagrant provision
```

ê³µì‹ ì´ë¯¸ì§€
![](./img/20250530.img/0016.png)

![](./img/20250530.img/0017.png)

```
vagrant -f destroy
```